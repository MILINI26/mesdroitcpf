<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vérifiez votre éligibilité CPF - Formation</title>
  <style>
    /* ... Styles conservés ... */
  </style>
</head>
<body>
  <header>
    <h1>Vérifiez votre éligibilité aux formations CPF</h1>
  </header>

  <div class="logos" aria-label="Logos officiels partenaires">
    <!-- Logos conservés -->
  </div>

  <nav>
    <a href="#formulaire">Vérifier votre éligibilité</a>
  </nav>

  <div class="warnings" role="alert" aria-live="assertive">
    <!-- Avertissements conservés -->
  </div>

  <section class="formations" aria-label="Liste des formations"></section>

  <section id="formulaire" aria-label="Formulaire d'éligibilité CPF">
    <h2>Formulaire d’éligibilité</h2>
    <form id="eligibiliteForm">
      <!-- Champs du formulaire conservés -->
      <button type="submit">Envoyer ma demande</button>
    </form>
    <div id="thankYouMessage" role="status" aria-live="polite" tabindex="0">
      Merci pour votre demande !<br />
      Ne soumettez pas une nouvelle demande.<br />
      Vous serez recontacté rapidement et recevrez le code de suivi AR26.
    </div>
  </section>

  <script>
    const formations = [
      // Liste des formations conservée
    ];

    const container = document.querySelector('.formations');
    const selectFormation = document.querySelector('#formation');

    formations.forEach(f => {
      const card = document.createElement('div');
      card.className = 'card';
      card.tabIndex = 0;
      card.setAttribute('role', 'button');
      card.setAttribute('aria-label', `Vérifier l'éligibilité pour la formation ${f.titre}`);

      card.innerHTML = `
        <img src="${f.img}" alt="Image représentant la formation ${f.titre}" />
        <div class="card-content">
          <h3>${f.titre}</h3>
          <p>${f.desc}</p>
          <div class="btn-eligibilite" tabindex="0">Vérifier votre éligibilité</div>
        </div>
      `;

      container.appendChild(card);

      const scrollHandler = () => scrollToForm(f.titre);
      card.querySelector('.btn-eligibilite').addEventListener('click', scrollHandler);
      card.addEventListener('click', scrollHandler);
      card.addEventListener('keypress', (e) => {
        if (e.key === 'Enter' || e.key === ' ') scrollHandler();
      });

      const option = document.createElement('option');
      option.value = f.titre;
      option.textContent = f.titre;
      selectFormation.appendChild(option);
    });

    function scrollToForm(formation) {
      selectFormation.value = formation;
      document.getElementById("formulaire").scrollIntoView({ behavior: 'smooth' });
      selectFormation.focus();
    }

    const form = document.getElementById("eligibiliteForm");
    const message = document.getElementById("thankYouMessage");

    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const data = new FormData(form);
      const payload = Object.fromEntries(data.entries());

      try {
        await fetch("https://script.google.com/macros/s/AKfycbyvFDCrylG0OTBK98FBVBhySdHww-vW9X0KpOwtv3S2lwWc8yScqFeLSUbCZu69KDZr/exec", {
          method: "POST",
          mode: "no-cors",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        form.reset();
        form.style.display = "none";
        message.style.display = "block";
        message.focus();
      } catch (err) {
        alert("Erreur lors de l'envoi. Veuillez réessayer.");
      }
    });
  </script>
</body>
</html>
